# House_Price_Prediction
[머신러닝 / 회귀]  서울의 아파트 실거래가를 예측하는 모델을 개발


## Summary

### 🛠️ 문제 정의

- **목표**: 서울 아파트 실거래가 예측 모델을 개발하여 부동산 시장 가격 변동성을 이해하고, 구매자 및 판매자에게 유익한 정보를 제공, 정부는 시세 모니터링 및 부정 거래 감지 정보 제공

### ⚙️ 수행 역할
- **데이터 전처리**:
  - 결측치 비율이 높은 컬럼을 삭제하고, 외부 데이터를 활용하여 결측치를 대체
  - 다양한 전처리 작업 수행: 강남 여부, 신축 여부, 전용면적와 같은 추가 변수를 생성하고, 건설사 및 아파트 명칭과 같은 범주형 변수를 축소
  
- **모델 학습 및 비교**:
  - XGBoost, LightGBM, CatBoost 모델을 활용하여 성능을 비교하고, 최적의 예측 성능을 위한 앙상블 기법 적용

### 📈 결과 및 직무에 적용할 점
1. **모델 성능 향상**: 다양한 모델과 앙상블 기법을 통해 예측 성능을 극대화할 수 있는 전략을 개발
2. **EDA의 중요성**: EDA를 통한 피처 엔지니어링으로 모델의 성능을 효과적으로 향상시킬 수 있음을 확인
3. **부동산 시장 이해 증진**: 서울 아파트 시장의 가격 변동성을 이해하고, 이를 기반으로 한 데이터 기반 의사결정 능력을 향상

<br><br>


$${\color{gray}(※ 아래는 프로젝트의 상세 내용 입니다.)}$$
## 상세

### 📝 데이터 수집
* **데이터셋 설명**
  * 데이터 형태: csv 파일
  * 데이터 기간: train(2007.01.01 ~ 2023.06.30), test(2023.07.01 ~ 2023.09.26)
  * 데이터 개수: train(1118822 개), test(9272 개)
  * 아파트 정보에 대한 변수: 52 개( + 거래시점에 대한 변수)
  * 서울시 지하철역, 버스 정류장에 대한 데이터
    
데이터 출처: [서울시 아파트 매매 관련 데이터](https://aistages-api-public-prod.s3.amazonaws.com/app/Competitions/000299/data/data.tar)

---
### 🔍 📊 데이터 전처리 & EDA
* **결측치 처리**
    * 'K-' 붙은 변수의 결측치 비율이 대체적으로 높은 것을 확인
      ![image](https://github.com/user-attachments/assets/87addd61-8fb1-417c-b7aa-014d8fa975c8)
    * 특정 의미 없는 value np.nan 처리
    * 결측치가 90% 이상을 차지하는 피처 → Deletion / 나머지 피처 → Imputation
    * 연속형 변수: 선형보간 / 범주형 변수: NULL 임의의 범주로 대체
    * `본번/부번`: `도로명` 기준으로 Imputation
    * `좌표X/좌표Y`:  네이버 API를 사용하여 x, y 결측치(경도, 위도) Imputation, 도로명 주소를 사용하여 x, y 결과값 획득
* **범주 축소**
    * `아파트명`
        * n동, n차, n단지 등등 제거, 같은 이름으로 병합
        * 정규표현식 이용
        * 6586개 → 4362개로 cardinality 축소
    * `K-건설사`
        * 같은 회사임에도 영어와 한글이 혼용되어 사용하는 경우 존재(e.g. GS건설, 지에스 건설)
        * 345개 → 136개로 cardinality 축소
* **Feature Engineering**
  * `강남 여부`
    * 일반적으로 강남, 강북에 위치에 따라 아파트 매매 가격의 차이가 존재함을 확인
      ![image](https://github.com/user-attachments/assets/0d78a748-701f-4c19-94c7-82f2066310d4)

    * 강남/강북 기준으로 파생변수 생성
      
  * `신축 여부`
    * 신축인지, 구축인지의 여부도 실거래가에 큰 영향을 줄 수 있다고 판단
    * 변수 분포 상 2009년 이후에 지어진 건물은 10%정도 되는 것을 확인<br>
    ![image](https://github.com/user-attachments/assets/10501b9f-be6e-485a-ae1c-86227c9abf75)
    * 2009년 이후에 지어졌으면 비교적 신축이라고 판단
    
  * `전용면적 구분`
    * 대체적으로 전용면적이 클 수록, 집값이 높아지는 경향<br>
      ![image](https://github.com/user-attachments/assets/64cf141c-0420-42a4-a22c-e5001f7b48cd)

    * 전용면적이 클수록 집값 분포가 커지는 다른 요인 존재한다 판단 → 전용면적별 파생변수 생성하여 세부적으로 학습할 수 있도록 함
    * 전용면적 별로 feature 생성(범주에 해당하는 경우 1, 그렇지 않으면 0)
        * 전용면적 <= 60
        * 60 < 전용면적 <= 85
        * 85 < 전용면적 <= 135
        * 135 < 전용면적
      
---
### 🧠 모델링
* **평가 지표**
  * RMSE(Root Mean Squared Error) 평가지표
      * 예측된 값과 실제 값 간의 평균편차
      * 아파트 매매에서 회귀 모델이 예측한 가격과 실제 거래 가격의 차이를 얼마나 잘 잡아내는지 측정
        
* **모델 구성 및 학습**

1. 모델 별 성능 평가(Baseline):

<div align="center">

| 모델명     | Public LB      |
|----------|-----------------|
| XGBoost | 24163.5940 |
| LGBM | 30403.3131 |
| CatBoost | 22097.2588 |

</div>

    - default params 기준, CatBoost의 성능이 가장 좋게 나옴
    - 다만, CatBoost는 default가 잘 세팅되어있고, LGBM은 가장 hyper-params-sensitive한 모델임을 고려
    

  2. 모델 별 성능 평가(Hyperparameter-tuning):
      
    - Optuna로 하이퍼 파라미터 튜닝 진행

<div align="center">

| 모델명     | 튜닝 전      | 튜닝 후      |
|----------|-----------------|----------|
| LGBM | 30403.3131 | 18271.0504 |
| CatBoost | 22097.2588 | 20085.8715 |

</div>
    


* **새로운 접근 방식의 앙상블 시도**

  ``` 하나의 컬럼 `전용면적`을 기준으로 분할 학습 및 결과 앙상블로 모델링 구성 ```

  - 전용면적의 범위 분할 기준에 대한 실험 중, 비교적 전용면적의 범위에 따른 모델 성능 변동성 발생 확인
  - 방식: 전용면적 범위를 기준으로 4개의 데이터로 분할 후, 각 데이터마다 모델 학습 및 추론 후 앙상블
  - 아래 기준으로 모델 통칭:
    <div align="center">

      | 모델 통칭명  | 전용범위 기준 |
      |--------------|---------|
      | A | 전용면적 <= 60 |
      | B | 60 < 전용면적 <= 85  |
      | C | 85 < 전용면적 <= 135  |
      | D | 135 < 전용면적  |
      
    </div>
 
  - 각 구간별 데이터 분포
    <div align="center">
      
      ![image](https://github.com/user-attachments/assets/0e5bc2b5-dd1c-4740-908b-e4851e06e3b8)

    </div>
    
  3. 모델 별 성능 평가(앙상블):
  

<div align="center">

| 모델명     | Public LB    |
|----------|-----------------|
| LGBM + CatBoost (Basic) | 20376.9040 |
| LGBM(New) | 16714.4593 |
| CatBoost(New) | 19479.3534 |

</div>
    
    - Basic: 기존 모델 앙상블
    - New: 위에서 정의된 전용면적 범위 컬럼을 기준으로 분할 학습 후의 모델 앙상블
    - 모델별 RSME 결과로 아래 이미지는 로컬에서 얻은 결과(CV)
  <div align="center">

  ![image](https://github.com/user-attachments/assets/79de6c68-9335-4f7b-9a31-901f1044e5dc)

</div>


* **결과**
  - `전용면적` 컬럼을 기준으로 학습한 LGBM 모델 앙상블이 가장 좋은 성능을 보여줌

---
### 🎯 결과 및 기대효과
* 하나의 컬럼을 기준으로 데이터를 분할 후, 각 데이터 별 모델을 앙상블하는 새로운 접근 방식의 앙상블이 성능 향상에 유의미한 결과를 보여줌

* **시장 분석**: 각 전용면적 범위에 따른 가격 변동성을 세분화하여 분석함으로써, 부동산 시장의 다양한 특성을 이해하는 데 기여
* **의사결정 지원**: 예측 결과를 활용하여 구매자 및 판매자가 더욱 합리적인 의사결정을 할 수 있도록 지원, 정부의 부동산 정책 수립 및 시세 모니터링에 유용한 데이터 제공







